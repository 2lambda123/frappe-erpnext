{% include "templates/includes/grouped_report_print.html" %}

<style>
@media screen {
	.print-format {
		padding: 8mm;
	}
}

.print-format {
	font-size: 8pt;
}
.print-format td, .print-format th {
	vertical-align: middle !important;
}
</style>

{% function print_group(data, group) { %}
<h2 class="text-center" style="margin-top:0;">{%= __("Stock Ledger") %}</h2>
<h4 class="text-center">
	{% if (filters.party) { %}
		{%= filters.party %}
	{% } %}
</h4>

<h5 class="text-center">
	{%= frappe.datetime.str_to_user(filters.from_date) %}
	{%= __("to") %}
	{%= frappe.datetime.str_to_user(filters.to_date) %}
</h5>
<table class="table table-bordered">
	<thead>
		<tr>
			<th class="text-center">{%= __("Date") %}</th>
			<th class="text-center">{%= __("Voucher") %}</th>
			<th class="text-center">{%= __("Item") %}</th>
			<th class="text-center">{%= __("Warehouse") %}</th>
			{% if(!filters.party) { %}
			<th class="text-center">{%= __("Party") %}</th>
			{% } %}
			<th class="text-center">{%= __("UOM") %}</th>
			<th class="text-center">{%= __("Qty") %}</th>
			<th class="text-center">{%= __("Balance Qty") %}</th>
		</tr>
	</thead>
	<tbody>
		{% for(var i=0, l=data.length; i<l; i++) { %}
			<tr>
			{% if(data[i].voucher_type) { %}
				<td class="text-center text-nowrap">
                    {%= (frappe.datetime.str_to_user(data[i].date) || "").split(" ").join("<br />") %}
                </td>

				<td class="text-center text-nowrap">
					{% if(data[i].voucher_no) { %}
                    <strong><a href="#Form/{%= data[i].voucher_type %}/{%= data[i].voucher_no %}" target="_blank">{%= data[i].voucher_no %}</a></strong>
                    {% } %}
                    <div>{%= data[i].voucher_type %}</div>
				</td>

				<td>
                    <a href="#Form/Item/{%= data[i].item_code %}" target="_blank">{%= data[i].item_code %}</a>
					{% if(data[i].item_name && data[i].item_name != data[i].item_code) { %}
					<br />data[i].item_name
					{% } %}
				</td>

				<td><a href="#Form/Warehouse/{%= data[i].warehouse %}" target="_blank">{%= (data[i].warehouse || " - ").split(" - ")[0] %}</a></td>

				{% if(!filters.party) { %}
				<td>
					{%= data[i].party_type %}
					<br /><a href="#Form/{%= data[i].party_type %}/{%= data[i].party %}" target="_blank">{%= data[i].party %}</a>
				</td>
				{% } %}

				<td class="text-center">{%= data[i].uom %}</td>
				<td class="text-right text-nowrap">{%= data[i].actual_qty ? format_number(data[i].actual_qty) : "" %}</td>
				<td class="text-right text-nowrap">{%= format_number(data[i].qty_after_transaction) %}</td>
			{% } else { %}
                {% var colspan = 7 %}
                {% if(!filters.party) { colspan++; } %}
                <td colspan="{%= colspan %}"></td>
			{% } %}
			</tr>
		{% } %}
	</tbody>
</table>
<p class="text-right text-muted">Printed On {%= frappe.datetime.str_to_user(frappe.datetime.get_datetime_as_string()) %}</p>
{% } %}

{{ print_report_groups(data, print_group) }}
